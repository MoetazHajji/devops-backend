pipeline {
environment { 
    registry = "iheblafi"
    registryCredential = 'iheblafi' 
    dockerImage = '' 

    }
    agent any
    
    stages {

        stage('Build et Push Docker Image') {
    steps {
        script {
            // Construire l'image Docker
            sh 'docker build -t iheblafi/gestion-station-ski:latest .'
        }
    }
}
        stage('Push vers DockerHub') {
    steps {
        script {
        docker.withRegistry( '', registryCredential ) {
            sh 'docker push iheblafi/gestion-station-ski:latest'
            }
        }
    }
}


        stage('Docker-compose') {
            steps {
               script {
                sh 'docker compose up -d -b'
              }
                
            }
        }

    }
      }
